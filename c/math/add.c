#include <Ubject.h>

#include "../core/base.h"
#define NODE_PROTECTED
#define VAR_PROTECTED
#include "add.r.h"

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////
/// Static function declarations
//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

#define STATIC_FUNC_DECL

static void *solve_add(struct laud_add *add);

#undef STATIC_FUNC_DECL

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////
/// Class Initializer
//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

#define CLASS_INIT

const void *LaudAdd = NULL;
const void *LaudAddClass = NULL;

static void __attribute__((constructor(LAUD_ADD_PRIORITY)))
library_initializer(void) {
  if (!LaudAddClass) {
    LaudAddClass = LaudVarClass;
  }
  if (!LaudAdd) {
    LaudAdd = init(LaudAddClass, LaudVar,
                   sizeof(struct laud_add),  // class parent size
                   className, "LaudAdd",     // class name
                   evaluate_node, solve_add, // evaluate_node
                   NULL);
  }
}

#undef CLASS_INIT

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////
/// Implemention
//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

#define IMPL

static void *solve_add(struct laud_add *add) {
  return laud_add(narray((struct laud_var *)incoming_nodes(add)[0]),
                  narray((struct laud_var *)incoming_nodes(add)[1]));
}